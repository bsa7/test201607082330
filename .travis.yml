language: ruby

cache:
  bundler: true

env:
  - NODE_ENV=test PGPORT=5433 PGHOST=localhost DB=postgres RAILS_ENV=test SH=bash

bundler_args: --without test --jobs 3 --retry 3

before_install:
  - "rm ${BUNDLE_GEMFILE}.lock"

before_script:
  - sudo cp /etc/postgresql/9.4/main/pg_hba.conf /etc/postgresql/9.5/main/pg_hba.conf
  - sudo /etc/init.d/postgresql restart
  - psql -U postgres -c 'create database "travis-db-test";'
  - psql -U postgres travis-db-test -c 'create extension "uuid-ossp";'
  - bundle

rvm:
  - 2.3.1
